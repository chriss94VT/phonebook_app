(window.webpackJsonpphonebook_react=window.webpackJsonpphonebook_react||[]).push([[0],{17:function(e,t,n){e.exports=n(43)},22:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(15),u=n.n(c),o=(n(22),n(1)),l=n.n(o),s=n(2),i=n(3),p=function(e){var t=e.message;return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{style:{color:"black"}},t))},f=n(5),m=n.n(f),v={login:function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/auth",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),checkStatus:function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("".concat("/api/auth","/checkStatus?token=").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},b=function(){var e=function(e){var t=Object(a.useState)(""),n=Object(i.a)(t,2),r=n[0],c=n[1];return{type:e,value:r,clearValue:function(){c("")},setValue:c,onChange:function(e){c(e.target.value)}}}("test"),t=Object(a.useState)(""),n=Object(i.a)(t,2),c=n[0],u=n[1],o=Object(a.useState)(""),f=Object(i.a)(o,2),m=f[0],b=f[1],d=function(){var t=Object(s.a)(l.a.mark((function t(n){var a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a={username:e,password:c},t.prev=2,t.next=5,v.login(a);case 5:r=t.sent,localStorage.setItem("token",r.token),e.clearValue(),u(""),b("Log in Successful"),window.location.reload(),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),b("Failed to Log In"),console.error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[2,13]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("h2",null,"Login"),r.a.createElement(p,{message:m}),r.a.createElement("form",null,"username:"," ",r.a.createElement("input",{onChange:e.onChange,value:e.value,type:"text"}),r.a.createElement("br",null),"password:"," ",r.a.createElement("input",{onChange:function(e){u(e.target.value)},value:c,type:"password"}),r.a.createElement("br",null),r.a.createElement("input",{onClick:d,value:"Login",type:"submit"}))))},d=n(16),h=n.n(d),w=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(i.a)(n,2),u=c[0],o=c[1];w.PropTypes={buttonLabel:h.a.func.isRequired};var l=function(){o(!u),console.log(u)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),r.a.createElement("div",null,r.a.createElement("div",null,u?e.children:null),r.a.createElement("div",null,r.a.createElement("button",{onClick:l},e.buttonLabel)))})),E=w,g="/api/persons",k="Bearer ".concat(localStorage.getItem("token")),x=function(){var e=Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get(g,{headers:{Authorization:k}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post(g,t,{headers:{Authorization:k}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(s.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.put("".concat(g,"/").concat(t),n,{headers:{Authorization:k}});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y={getAll:x,create:j,remove:function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.delete("".concat(g,"/").concat(t),{headers:{Authorization:k}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:O},S=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],u=Object(a.useState)(""),o=Object(i.a)(u,2),f=o[0],m=o[1],d=Object(a.useState)(""),h=Object(i.a)(d,2),w=h[0],g=h[1],k=Object(a.useState)(""),x=Object(i.a)(k,2),j=x[0],O=x[1],S=Object(a.useState)(""),C=Object(i.a)(S,2),L=C[0],A=C[1],I=Object(a.useState)(!1),z=Object(i.a)(I,2),N=z[0],V=z[1];Object(a.useEffect)(Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.checkStatus(window.localStorage.getItem("token"));case 3:t=e.sent,V(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[]);var F=function(){var e=Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.getAll();case 3:t=e.sent,c(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)(F,[]);var R=n.map((function(e){if(e.name.toLowerCase().trim().includes(j.toLowerCase().trim()))return r.a.createElement("div",{key:e.name},r.a.createElement("p",null,e.name," ",e.number),r.a.createElement("button",{onClick:function(){return B(e)}},"delete"))})),T=function(){var e=Object(s.a)(l.a.mark((function e(t){var a,r,u,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),u={name:f,number:w},n.forEach(function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.name.toLowerCase().trim()!==f.toLowerCase().trim()){e.next=18;break}if(a=!0,r=window.confirm("".concat(f," has already been added to the phonebook, would you like to replace the number?")),e.prev=3,!r){e.next=13;break}return e.next=7,y.update(t.id,u);case 7:return e.next=9,y.getAll();case 9:n=e.sent,c(n),m(""),g("");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.error(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}()),a){e.next=18;break}return e.prev=4,e.next=7,y.create(u);case 7:o=e.sent,c(n.concat(o)),m(""),g(""),A("Added ".concat(f)),setTimeout((function(){A(null)}),5e3),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.error(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.remove(t.id);case 3:return e.next=5,y.getAll();case 5:n=e.sent,c(n),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),A("Information for ".concat(t.name," has already been removed from the server.")),setTimeout((function(){A(null)}),5e3);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),D=r.a.createRef();return r.a.createElement("div",null,r.a.createElement("h1",null,"Phonebook"),r.a.createElement(E,{buttonLabel:"Show Log In",ref:D},r.a.createElement(b,null)),r.a.createElement("div",null,N?r.a.createElement("div",null,r.a.createElement(p,{message:L}),r.a.createElement("div",null,"filter shown with"," ",r.a.createElement("input",{onChange:function(e){O(e.target.value)},value:j})),r.a.createElement("div",null,r.a.createElement(E,{buttonLabel:"New Entry"},r.a.createElement("h2",null,"Add New Number"),r.a.createElement("form",{onSubmit:T},r.a.createElement("div",null,"name: ",r.a.createElement("input",{onChange:function(e){m(e.target.value)},value:f})),r.a.createElement("div",null,"number:"," ",r.a.createElement("input",{onChange:function(e){g(e.target.value)},value:w})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"add"))))),r.a.createElement("h2",null,"Numbers"),r.a.createElement("div",null,R)):null))};u.a.render(r.a.createElement(S,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.894a14cb.chunk.js.map